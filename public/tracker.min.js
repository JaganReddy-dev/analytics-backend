(() => {
  const e = () => ({
      url: window.location.href,
      device: /Mobile|Android|iPhone|iPad/i.test(navigator.userAgent)
        ? "Mobile"
        : "Desktop",
      userAgent: navigator.userAgent,
      referrer: document.referrer,
      screenWidth: window.screen.width,
      screenHeight: window.screen.height,
    }),
    t = (e, t) => {
      const n = `http://localhost:4000/collect/${e}`;
      navigator.sendBeacon
        ? navigator.sendBeacon(n, JSON.stringify(t))
        : fetch(n, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(t),
          }).catch((e) => {
            console.error(e.error);
          });
    };
  t("visitor", e());
  const n = (n, o = {}) => {
    t({ type: n, website: window.location.hostname, ...e(), ...o });
  };
  n("pageview"),
    document.addEventListener("click", (e) => {
      n("click", {
        tag: e.target.tagName,
        id: e.target.id,
        classes: e.target.className,
      });
    });
})();
