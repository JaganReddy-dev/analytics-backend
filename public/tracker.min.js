const CONFIG={BASE_URL:"http://localhost:4000/collect",SCROLL_CHECKPOINTS:[25,50,75,100],SCROLL_THROTTLE_MS:500};console.log("currently monitoring");const api={send(t,e){const i=`${CONFIG.BASE_URL}/${t}`;navigator.sendBeacon?navigator.sendBeacon(i,new Blob([JSON.stringify(e)],{type:"application/json"})):fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).catch(t=>console.error("Tracking error:",t))},trackEvent(t,e,i={}){this.send("event",{type:t,action:e,website:window.location.href,metadata:i})},trackVisitor(t){this.send("visitor",t)}},visitorCollector={collect:()=>({url:window.location.href,userAgent:navigator.userAgent,referrer:document.referrer||"direct",screenWidth:window.screen.width,screenHeight:window.screen.height})},clickTracker={trackables:[{attr:"trackify-navigate",type:"navigation-click"},{attr:"trackify-button",type:"button-click"}],init(){document.addEventListener("click",this.handleClick.bind(this))},handleClick(t){for(const e of this.trackables){const i=t.target.closest(`[${e.attr}]`);if(i){const t=i.getAttribute(e.attr);api.trackEvent(e.type,t,{element:e.attr});break}}}},scrollTracker={reached:new Set,init(){window.addEventListener("scroll",this.throttle(this.handleScroll.bind(this),CONFIG.SCROLL_THROTTLE_MS))},getScrollPercent(){const t=window.scrollY,e=document.documentElement.scrollHeight-window.innerHeight;return Math.round(t/e*100)},handleScroll(){const t=this.getScrollPercent();for(let e of CONFIG.SCROLL_CHECKPOINTS)t>=e&&!this.reached.has(e)&&(this.reached.add(e),api.trackEvent("scroll-depth","scroll",{depth:e}))},throttle(t,e){let i=0;return(...n)=>{const o=Date.now();o-i>=e&&(i=o,t(...n))}}},locationTracker={init(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(this.handleSuccess.bind(this),this.handleError.bind(this))},handleSuccess(t){api.trackEvent("location","geolocation",{lat:t.coords.latitude,lon:t.coords.longitude,accuracy:t.coords.accuracy})},handleError(){api.trackEvent("location","ip_fallback")}},Trackify={init(){api.trackVisitor(visitorCollector.collect()),api.trackEvent("pageview","page_load"),clickTracker.init(),scrollTracker.init(),locationTracker.init()}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>Trackify.init()):Trackify.init();